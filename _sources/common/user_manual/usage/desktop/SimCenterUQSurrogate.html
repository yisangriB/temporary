

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>2.1.2.3. Surrogate Modeling &mdash; Quantified Uncertainty with Optimization for the FEM  documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sphinxcontrib-images\LightBox2\lightbox2\css\lightbox.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinxcontrib-images\LightBox2\lightbox2\js\jquery-1.11.0.min.js"></script>
        <script src="../../../../_static/sphinxcontrib-images\LightBox2\lightbox2\js\lightbox.min.js"></script>
        <script src="../../../../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\jquery-noconflict.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="2.1.3.1. Transitional Markov chain Monte Carlo (TMCMC) algorithm" href="UCSD_UQ_TMCMC.html" />
    <link rel="prev" title="2.1.2.2. Global Sensitivity Analysis" href="SimCenterUQSensitivity.html" />
<script src="https://cdn.jsdelivr.net/npm/vega@5.12.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.13.1"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.8.0"></script>
<style media="screen">.vega-actions a {margin-right: 5px;}</style>
<link href="../../../../_static/css/bootstrap.css" rel="stylesheet">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F2F2F2" >
          
<a href="https://simcenter.designsafe-ci.org/" style="margin-bottom: 0px;">
  <img src="../../../../_static/img/SimCenter-Only.png" class="logo" alt="Org-Logo" />
</a>
<hr style="margin: 0px;">

  <a href="../../../../index.html">



  
  <img src="../../../../_static/quoFEM-Logo.png" class="logo" alt="Logo"/>

</a>


  
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/quoFEM/aboutQUOFEM.html">1. About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../front-matter/ack.html">2. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../front-matter/license.html">3. Copyright and License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../front-matter/glossary.html">4. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../front-matter/abbreviations.html">5. Abbreviations</a></li>
</ul>
<p class="caption"><span class="caption-text">User Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation/desktop/installation.html">1. Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="usage.html">2. User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="UQ.html">2.1. UQ: Uncertainty Quantification</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="UQ.html#dakota-uq-engine">2.1.1. Dakota UQ Engine</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="UQ.html#simcenter-uq-engine">2.1.2. SimCenter UQ Engine</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="SimCenterUQSampling.html">2.1.2.1. Forward Propagation Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="SimCenterUQSensitivity.html">2.1.2.2. Global Sensitivity Analysis</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">2.1.2.3. Surrogate Modeling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="UQ.html#ucsd-uq-engine">2.1.3. UCSD UQ Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="UQ.html#custom-uq-engine">2.1.4. Custom UQ Engine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quoFEM/FEM.html">2.2. FEM: Finite Element Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="quoFEM/QuantitiesOfInterest.html">2.3. QoI: Quantities of Interest</a></li>
<li class="toctree-l2"><a class="reference internal" href="RV.html">2.4. RV: Random Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/desktop/troubleshooting.html">3. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/desktop/examples.html">4. Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reqments/reqQUOFEM.html">5. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bugs.html">6. Bugs &amp; Feature Requests</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../technical_manual/desktop/technical_manual.html">1. Technical Manual</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_manual/how_to_build/desktop/how_to_build.html">1. How to Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_manual/architecture/desktop/architecture.html">2. Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_manual/how_to_extend/desktop/how_to_extend.html">3. How to Extend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_manual/verification/desktop/verification.html">4. Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_manual/coding_style/desktop/coding_style.html">5. Coding Style</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Quantified Uncertainty with Optimization for the FEM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="usage.html"><span class="section-number">2. </span>User Guide</a> &raquo;</li>
        
          <li><a href="UQ.html"><span class="section-number">2.1. </span>UQ: Uncertainty Quantification</a> &raquo;</li>
        
      <li><span class="section-number">2.1.2.3. </span>Surrogate Modeling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/common/user_manual/usage/desktop/SimCenterUQSurrogate.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="surrogate-modeling">
<span id="lblsimsurrogate"></span><h1><span class="section-number">2.1.2.3. </span>Surrogate Modeling<a class="headerlink" href="#surrogate-modeling" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Surrogate modeling functionality of quoFEM is built upon <a class="reference external" href="https://sheffieldml.github.io/GPy/">GPy</a> library (available under BSD 3-clause license), an opensource python framework for Gaussian process modeling developed in the Sheffield machine learning group.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Train</span> <span class="pre">GP</span> <span class="pre">Surrogate</span> <span class="pre">Model</span></code> module is used to construct a Gaussian process (GP) based <strong>surrogate model</strong> that substitutes expensive computational <strong>simulation models</strong> or physical experiments. Consider a simulation model, with input random variables (or parameters) <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> and output quantity of interests <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span>, denoted as <span class="math notranslate nohighlight">\(\boldsymbol{y}=f(\boldsymbol{x})\)</span>. A surrogate model for the corresponding simulation model can be built by different user-provided information types:</p>
<table class="colwidths-given docutils align-default" id="id1">
<caption><span class="caption-number">Table 2.1.2.3.1 </span><span class="caption-text">User-provided information types</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 43%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>RV (model input <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span>)</p></th>
<th class="head"><p>QoI (model response <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Case1</strong></p></td>
<td><p>bounds of random variables <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span></p></td>
<td><p>simulation model: <span class="math notranslate nohighlight">\(\boldsymbol{y}=f(\boldsymbol{x})\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Case2</strong></p></td>
<td><p>dataset: <span class="math notranslate nohighlight">\(\{\boldsymbol{x^{(1)},x^{(2)}, ... ,x^{(N)}}\}\)</span></p></td>
<td><p>simulation model: <span class="math notranslate nohighlight">\(\boldsymbol{y}=f(\boldsymbol{x})\)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>Case3</strong></p></td>
<td><p>dataset: <span class="math notranslate nohighlight">\(\{\boldsymbol{x^{(1)},x^{(2)}, ... ,x^{(N)}}\}\)</span></p></td>
<td><p>dataset: <span class="math notranslate nohighlight">\(\{\boldsymbol{y^{(1)},y^{(2)}, ... ,y^{(N)}}\}\)</span></p></td>
</tr>
</tbody>
</table>
<p><strong>Case 1 (Sampling and Simulation)</strong>: User provides lower and upper bounds of each random variable (RV) and a simulation model. quoFEM will find the best training points sequentially by the adaptive <strong>design of experiments</strong> strategies until the model converges or reaches a user-specified computational tolerance.</p>
<p><strong>Case 2 (Import RV Dataset and run Simulation)</strong>: User provides sample population of RVs as a separate text file. quoFEM will run simulations to get QoI values and build a surrogate model.</p>
<p><strong>Case 3 (Import both RV and QoI Dataset)</strong>:  User provides sample population of RVs and QoIs. quoFEM will not run any simulations and build a surrogate model purely based on the provided dataset.</p>
<table class="colwidths-given docutils align-center" id="id2">
<caption><span class="caption-number">Table 2.1.2.3.2 </span><span class="caption-text">quoFEM workflow</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 12%" />
<col style="width: 29%" />
<col style="width: 29%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Sampling (Adaptive DoE)</p></th>
<th class="head"><p>Model simulation</p></th>
<th class="head"><p>Surrogate Construction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Case1</strong></p></td>
<td><p>O</p></td>
<td><p>O</p></td>
<td><p>O</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Case2</strong></p></td>
<td><p>X</p></td>
<td><p>O</p></td>
<td><p>O</p></td>
</tr>
<tr class="row-even"><td><p><strong>Case3</strong></p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>O</p></td>
</tr>
</tbody>
</table>
<p><strong>The trained surrogate model can be saved in a file (.pkl format) along with a meta-information (.json format) and later imported in quoFEM</strong> in place of the original simulation model for UQ analysis or optimization purposes. See 2.2.5 for how to import the surrogate model in quoFEM.</p>
<div class="section" id="input-description">
<h2>Input description<a class="headerlink" href="#input-description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="case-1-sampling-and-simulation">
<h3>Case 1: Sampling and Simulation<a class="headerlink" href="#case-1-sampling-and-simulation" title="Permalink to this headline">¶</a></h3>
<p>When the <strong>Training Dataset</strong> option is set to the <code class="docutils literal notranslate"><span class="pre">Sampling</span> <span class="pre">and</span> <span class="pre">Simulation</span></code>, a simulation model should be presented in the <strong>FEM tab</strong>. The training points are sampled adaptively by the design of experiments.</p>
<div class="align-center figure" id="id3">
<span id="figsim1"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate1_SimUQ.jpg"><img alt="../../../../_images/Surrogate1_SimUQ.jpg" src="../../../../_images/Surrogate1_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.1 </span><span class="caption-text">Input panel for surrogate modeling</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<ul>
<li><p><strong>Random Seed</strong>: Seed of the random number generator</p></li>
<li><p><strong>Target Accuracy (Normalized Error)</strong>: The target accuracy is defined in terms of normalized root-mean squared error (NRMSE) estimated by leave-out-one cross-validation (LOOCV).</p>
<blockquote>
<div><blockquote>
<div><div class="math notranslate nohighlight" id="equation-nrmse">
<span class="eqno">(2.1.2.3.3)<a class="headerlink" href="#equation-nrmse" title="Permalink to this equation">¶</a></span>\[\begin{align*}
        \rm{NRMSE} ~ &amp;= \frac{\sqrt{\frac{1}{N} \sum^{N}_{k=1} (y_k-\hat{y}_k)^2}}{\max_{k=1,...,N}(y_k)-\min_{k=1,...,N}(y_k)}
\end{align*}\]</div>
</div></blockquote>
<div class="line-block">
<div class="line">where</div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(y_k\)</span> : exact response from the model simulation</div>
<div class="line"><span class="math notranslate nohighlight">\(\hat{y}_k\)</span>: estimated response by LOOCV surrogate model prediction</div>
<div class="line"><span class="math notranslate nohighlight">\(N\)</span>: number of samples used to train the surrogate model</div>
</div>
</div>
</div></blockquote>
</li>
<li><p><strong>Maximum Number of Model Runs</strong>: When the number of simulation runs reaches the limit, the analysis will be terminated.</p></li>
<li><p><strong>Maximum Computation Time (in minutes)</strong>: When the tolerance limit of the computation time is reached, the analysis will be terminated. There will be a few minutes of error.</p></li>
</ul>
<p>User can also activate the <strong>Advanced Options for Gaussian Process Model</strong></p>
<div class="align-center figure" id="id4">
<span id="figsim2"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate2_SimUQ.jpg"><img alt="../../../../_images/Surrogate2_SimUQ.jpg" src="../../../../_images/Surrogate2_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.2 </span><span class="caption-text">Sampling and Simulation - Case 1</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p><strong>Kernel function</strong>: Correlation function for Gaussian process regression. Matern5/2 function is the default, and Matern3/2, Radial Basis, and Exponential functions are additionally supported.</p></li>
<li><p><strong>Linear trend function</strong>: When increasing or decreasing trend is expected over the variables domain, a linear trend function may be introduced. The default is unchecked, ie. no trend function.</p></li>
<li><p><strong>Responses are always positive</strong>: When the user can guarantee that the response quantities are always greater than 0, user may want to introduce a surrogate model in log-transformed space. The default is unchecked, ie. original physical coordinate.</p></li>
<li><p><strong>Number of Initial Samples (Design of Experiments)</strong>: User may set the number of the initial design of experiments (DoE) manually, while the default is 4 times the number of random variables.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If the user wants to inactivate the adaptive DoE feature, one can set <strong>Number of Initial Samples</strong> equal to the <strong>Maximum Number of Model Runs</strong>. In this case, all the training samples will be generated at once by Latin hypercube sampling. The computation may be faster, but caution should be taken since the resulting verification measures are more likely to overestimate the level of accuracy and underestimate the error size.</p>
</div>
<p>Additionally, users may populate the initial samples directly from data files by activating <strong>Start with Existing Dataset</strong></p>
<div class="align-center figure" id="id5">
<span id="figsim3"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate3_SimUQ.jpg"><img alt="../../../../_images/Surrogate3_SimUQ.jpg" src="../../../../_images/Surrogate3_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.3 </span><span class="caption-text">Input panel for surrogate modeling</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>The following two data files are requested:</p>
<ul class="simple">
<li><p><strong>Train Points (Input)</strong></p></li>
<li><p><strong>System Responses (Output)</strong></p></li>
</ul>
<p>where</p>
<ul class="simple">
<li><p>Each text file is a numeric table with the columns separated by a tab, space, or comma. Multiple headers can be presented following the symbol %.</p></li>
<li><p>The number of rows corresponds to the number of training data samples.</p></li>
<li><p>Train Points (Input): The number of columns should match the number of RVs presented in the <strong>RV tab</strong> and also match with required inputs of the simulation model provided in the <strong>FEM tab</strong>. <strong>The order of the columns should match the random variables presented in the RV tab</strong> (See <a class="reference internal" href="#figsim4"><span class="std std-numref">Fig. 2.1.2.3.4</span></a> and <a class="reference internal" href="#figsim7"><span class="std std-numref">Fig. 2.1.2.3.7</span></a> for example.)</p></li>
<li><p>System Responses (Output): The number of columns  and the order of columns should match the QoI quantities presented in <strong>QoI tab</strong>.</p></li>
<li><p>Both files need to be provided, and the number of columns for the two files should be the same.</p></li>
<li><p>See <a class="reference internal" href="#figsim4"><span class="std std-numref">Fig. 2.1.2.3.4</span></a> for example input data sheets.</p></li>
</ul>
<div class="align-center figure" id="id6">
<span id="figsim4"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate4_SimUQ.jpg"><img alt="../../../../_images/Surrogate4_SimUQ.jpg" src="../../../../_images/Surrogate4_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.4 </span><span class="caption-text">Example of data input files</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>When the <strong>Start with Existing Dataset</strong> is checked, one redundant simulation will be performed in order to check the consistency between the data and the simulation model. An error will be thrown when the dataset cannot be reproduced by the simulation model.</p></li>
<li><p>If the user wants to use the samples purely from data files and does not wish to introduce any simulation model, refer to Case 3 below.</p></li>
</ul>
</div>
</div>
<div class="section" id="case-2-import-rv-dataset-and-run-simulation">
<h3>Case 2: Import RV Dataset and run Simulation<a class="headerlink" href="#case-2-import-rv-dataset-and-run-simulation" title="Permalink to this headline">¶</a></h3>
<p>When the <strong>Training Dataset</strong> option is set to <code class="docutils literal notranslate"><span class="pre">Import</span> <span class="pre">Data</span> <span class="pre">File</span></code> AND <strong>Get results from datafile</strong> check box is unchecked, quoFEM will run simulations to get result (QoI)  values for imported RV locations and build a surrogate model.</p>
<div class="align-center figure" id="id7">
<span id="figsim5"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate5_SimUQ.jpg"><img alt="../../../../_images/Surrogate5_SimUQ.jpg" src="../../../../_images/Surrogate5_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.5 </span><span class="caption-text">Import Data File - Case 2</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>The following data file is requested</p>
<ul class="simple">
<li><p><strong>Train Points (Input)</strong></p></li>
</ul>
<p>where</p>
<ul class="simple">
<li><p>The text file is a numeric table with columns separated by a tab, space, or comma. Multiple headers can be presented following the symbol %.</p></li>
<li><p>The number of rows corresponds to the number of training data samples.</p></li>
<li><p>The number of columns should match the number of RVs presented in the FEM model in the <strong>FEM tab</strong>. The order of columns should match those presented in the <strong>RV tab</strong>.</p></li>
<li><p>See <a class="reference internal" href="#figsim4"><span class="std std-numref">Fig. 2.1.2.3.4</span></a> (left) for an example data file.</p></li>
</ul>
</div>
<div class="section" id="case-3-import-both-rv-and-qoi-dataset">
<h3>Case 3: Import both RV and QoI Dataset<a class="headerlink" href="#case-3-import-both-rv-and-qoi-dataset" title="Permalink to this headline">¶</a></h3>
<p>When the <strong>Training Dataset</strong> option is set to <code class="docutils literal notranslate"><span class="pre">Import</span> <span class="pre">Data</span> <span class="pre">File</span></code> AND <strong>Get results from datafile</strong> check box is unchecked, quoFEM will not run any simulations and build a surrogate model purely based on the user-provided dataset.</p>
<div class="align-center figure" id="id8">
<span id="figsim6"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate6_SimUQ.jpg"><img alt="../../../../_images/Surrogate6_SimUQ.jpg" src="../../../../_images/Surrogate6_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.6 </span><span class="caption-text">Import Data File - Case 3</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>The following two data files are requested:</p>
<ul class="simple">
<li><p><strong>Train Points (Input)</strong></p></li>
<li><p><strong>System Responses (Output)</strong></p></li>
</ul>
<p>where</p>
<ul class="simple">
<li><p>Each text file is a numeric table with columns separated by a tab, space, or comma. Multiple headers can be presented following the symbol %.</p></li>
<li><p>The number of columns corresponds to the number of training data samples.</p></li>
<li><p>The number of rows of each file respectively corresponds to the number of RVs and QoIs.</p></li>
<li><p>Both files need to be presented, and the number of columns should correspond to each other.</p></li>
<li><p>See <a class="reference internal" href="#figsim4"><span class="std std-numref">Fig. 2.1.2.3.4</span></a> for example data files.</p></li>
</ul>
<p><strong>FEM tab</strong> will be inactivated in Case 3 as model information is not required.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul class="simple">
<li><p>Surrogate model can be continued after when they are terminated by saving and importing RV and QoI samples.</p></li>
</ul>
</div>
</div>
<div class="section" id="rv-random-variables-tab">
<h3>RV (Random Variables) Tab<a class="headerlink" href="#rv-random-variables-tab" title="Permalink to this headline">¶</a></h3>
<p><strong>Case 1 and 2</strong>: The bounds of RVs need to cover the domain of interest in future applications, while it should not be unnecessarily stretched. <strong>Input type</strong> and <strong>Distribution</strong> should be set to <strong>Parameters</strong> and <strong>Uniform</strong>. When dataset is provided, make sure to match the order of RVs in the <strong>RV tab</strong> to the order of data columns. Any correlation values will be ignored.</p>
<div class="align-center figure" id="id9">
<span id="figsim7"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate7_SimUQ.jpg"><img alt="../../../../_images/Surrogate7_SimUQ.jpg" src="../../../../_images/Surrogate7_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.7 </span><span class="caption-text">Example of RV tab</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p><strong>Case 3</strong>: <strong>RV data tab</strong> will be populated automatically as soon as the dataset is imported.</p>
</div>
</div>
<div class="section" id="output-description">
<h2>Output description<a class="headerlink" href="#output-description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="goodness-of-fit">
<h3>Goodness-of-Fit<a class="headerlink" href="#goodness-of-fit" title="Permalink to this headline">¶</a></h3>
<p>Once the training is completed, the following three verification measures are presented based on leave-one-out cross-validation (LOOCV) error estimation.</p>
<ul>
<li><p><strong>Leave-one-out cross-validation (LOOCV)</strong></p>
<div class="line-block">
<div class="line">LOOCV prediction <span class="math notranslate nohighlight">\(\hat{\boldsymbol{y}}_k\)</span> at each sample location <span class="math notranslate nohighlight">\(\boldsymbol{x}_k\)</span> is obatined by the following procedure: A temporary surrogate model <span class="math notranslate nohighlight">\(\hat{\boldsymbol{y}}=f^{sur}_{loo,k}(\boldsymbol{\boldsymbol{x}})\)</span> is constructed using the samples <span class="math notranslate nohighlight">\(\{\boldsymbol{x}_1,\boldsymbol{x}_2,...,\boldsymbol{x}_{k-1},\boldsymbol{x}_{k+1},...,\boldsymbol{x}_N\}\)</span> and the calibrated parameters, and the prediction <span class="math notranslate nohighlight">\(\hat{\boldsymbol{y}}_k=f^{sur}_{loo,k}(\boldsymbol{x}_k)\)</span> is compared with the exact outcome <span class="math notranslate nohighlight">\(y_k=f(\boldsymbol{x}_k)\)</span>.</div>
</div>
</li>
<li><p><strong>R2 error</strong></p>
<div class="line-block">
<div class="line">R2 error is defined in terms of the total sum of squares over the residual sum of squares</div>
</div>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-r2">
<span class="eqno">(2.1.2.3.2)<a class="headerlink" href="#equation-r2" title="Permalink to this equation">¶</a></span>\[\begin{align*}
        R^2 &amp;= 1 - \frac{\sum^N_{k=1} (\hat{y}_k-\mu_\hat{y})^2}{\sum^N_{k=1} (\hat{y}_k-y_k)^2}
\end{align*}\]</div>
</div></blockquote>
<div class="line-block">
<div class="line">The surrogate model is considered well-trained when the <strong>R2 (&lt;1) approaches 1</strong></div>
</div>
</li>
<li><p><strong>Normalized root-mean-squared-error (NRMSE)</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-nrmse">
<span class="eqno">(2.1.2.3.3)<a class="headerlink" href="#equation-nrmse" title="Permalink to this equation">¶</a></span>\[\begin{align*}
        \rm{NRMSE} ~ &amp;= \frac{\sqrt{\frac{1}{N_t} \sum^{N_t}_{k=1} (y_k-\hat{y}_k)^2}}{\max_{k=1,...,N_t}(y_k)-\min_{k=1,...,N_t}(y_k)}
\end{align*}\]</div>
</div></blockquote>
<div class="line-block">
<div class="line">The surrogate model is considered well-trained when the <strong>NRMSE (&gt;0) approaches 0</strong></div>
</div>
</li>
<li><p><strong>Correlation coefficient</strong></p>
<div class="line-block">
<div class="line">Correlation coefficient is a statistic that measures linear correlation between two variables</div>
</div>
<div class="math notranslate nohighlight" id="equation-corr">
<span class="eqno">(2.1.2.3.4)<a class="headerlink" href="#equation-corr" title="Permalink to this equation">¶</a></span>\[  \rho_{y,\hat{y}} = \frac{\sum^N_{k=1}(y_k-\mu_{y})(\hat{y}_k-\mu_{\hat{y}})} {\sigma_y \sigma_\hat{y}}\]</div>
<div class="line-block">
<div class="line">where</div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(\mu_{y}\)</span> : mean of <span class="math notranslate nohighlight">\(\{y_k\}\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(\mu_{\hat{y}}\)</span>: mean of <span class="math notranslate nohighlight">\(\{\hat{y}_k\}\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(\sigma_{y}\)</span>: standard deviation of <span class="math notranslate nohighlight">\(\{y_k\}\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(\sigma_{\hat{y}}\)</span>: standard deviation of <span class="math notranslate nohighlight">\(\{\hat{y}_k\}\)</span></div>
</div>
</div>
<div class="line-block">
<div class="line">The surrogate model is considered well-trained when the <strong>correlation coefficient (</strong> <span class="math notranslate nohighlight">\(-1&lt;\rho&lt;1\)</span> <strong>) approaches 1</strong></div>
</div>
</li>
<li><p>Additionally <strong>scatter plot</strong> between the predicted and exact responses are presented: Well-trained model will form a clear diagonal line while poorly trained model are more scattered around.</p></li>
</ul>
<div class="align-center figure" id="id10">
<span id="figsim8"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate8_SimUQ.jpg"><img alt="../../../../_images/Surrogate8_SimUQ.jpg" src="../../../../_images/Surrogate8_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.8 </span><span class="caption-text">Well-trained surrogate (left) and poorly trained surrogate (right) models</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since these validation measures are calculated from the cross-validation predictions, they can be <strong>biased</strong>, particularly when highly localized nonlinear range exists in actual response surface and those regions are not covered by the training samples. The introduction of adaptive DoE helps to suppress the bias by enabling the targeted selection of simulation points around potentially faulty regions.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that GP-based surrogate models are essentially developed to fit smooth, continuous functions. When the surrogate model is poorly trained, a parametric study is highly recommended to check any possible discontinuity presented in the simulation model.</p>
</div>
</div>
<div class="section" id="saving-options">
<h3>Saving Options<a class="headerlink" href="#saving-options" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Save GP Model</strong>: The constructed surrogate model is saved. Two files and a folder will be saved, which are the <strong>SurroateGP Info File</strong> (default name: <code class="docutils literal notranslate"><span class="pre">SimGpModel.json</span></code>), <strong>SurroateGP model file</strong> (default name: <code class="docutils literal notranslate"><span class="pre">SimGpModel.pkl</span></code>), and <strong>Simulation template directory</strong> that contains the simulation model information (<code class="docutils literal notranslate"><span class="pre">templatedir_SIM</span></code>). <strong>IMPORTANT</strong>: User may NOT change the name of the template directory <code class="docutils literal notranslate"><span class="pre">templatedir_SIM</span></code>.</p></li>
<li><p><strong>Save GP Info</strong>: This is a report file generated for user reference. It contains the GP model parameter and other information. The default file name is <code class="docutils literal notranslate"><span class="pre">GPresults.out</span></code>.</p></li>
<li><p><strong>RV Data</strong>, <strong>QoI Data</strong>:It saves the samples of RV and QoI. The default file names are <code class="docutils literal notranslate"><span class="pre">X.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">Y.txt</span></code>, respectively. <strong>IMPORTANT</strong>: To continue surrogate modeling with additional simulations, save the RV and QoI sample files using this button and import them as initial points. Refer to the ‘Start with Existing Dataset’ option in Case 1.</p></li>
</ul>
<div class="align-center figure" id="id11">
<span id="figsim9"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate9_SimUQ.jpg"><img alt="../../../../_images/Surrogate9_SimUQ.jpg" src="../../../../_images/Surrogate9_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.9 </span><span class="caption-text">Saving options</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id12">
<span id="figsim10"></span><a class="reference internal image-reference" href="../../../../_images/Surrogate10_SimUQ.jpg"><img alt="../../../../_images/Surrogate10_SimUQ.jpg" src="../../../../_images/Surrogate10_SimUQ.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1.2.3.10 </span><span class="caption-text">Example outputs from saving options</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, The Regents of the University of California.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-158130480-4', 'auto');
    
    ga('send', 'pageview');
    </script>

    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>

<script>
    /*
    let selectedFilters = [];
    const images  = document.getElementsByClassName("gallery-item");
    const filters = [...document.querySelectorAll('.filter select')];
    const toggles = [...document.querySelectorAll('.filter input')];

    var show = function (elem) {
        elem.style.display = 'block';
    };
    var hide = function (elem) {
        elem.style.display = 'none';
    };
    var toggleFilter =  function(el,elid) {
        const filter = document.getElementById(elid);
        filter.disabled = !el.checked;
       
        if ("createEvent" in document) {
            var evt = document.createEvent("HTMLEvents");
            evt.initEvent("change", false, true);
            filter.dispatchEvent(evt);
        }
        else
            filter.fireEvent("change");
    };
    
    for (const filter of filters) {
        filter.addEventListener('change', function(event) {
            selectedFilters = filters.map(filter => filter.disabled ? '' : filter.value).filter(Boolean);
            console.log(selectedFilters);
            for (const image of images) {
                if (selectedFilters.every(filter => image.classList.contains(filter))) {
                    show(image);
                }
                else {hide(image)};
            };
        })
    };
    */
</script>


</body>
</html>